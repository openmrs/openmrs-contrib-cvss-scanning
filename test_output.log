============================== test session starts ===============================
platform linux -- Python 3.9.7, pytest-7.4.3, pluggy-1.6.0 -- /opt/tljh/user/bin/python
cachedir: .pytest_cache
metadata: {'Python': '3.9.7', 'Platform': 'Linux-5.15.0-157-generic-x86_64-with-glibc2.35', 'Packages': {'pytest': '7.4.3', 'pluggy': '1.6.0'}, 'Plugins': {'base-url': '2.1.0', 'html': '4.1.1', 'json-report': '1.5.0', 'bdd': '6.1.1', 'metadata': '3.1.1', 'playwright': '0.7.1', 'anyio': '3.6.1'}, 'Base URL': ''}
rootdir: /home/jupyter-yin10/Continuous_Security/openmrs-contrib-cvss-scanning
configfile: pytest.ini
plugins: base-url-2.1.0, html-4.1.1, json-report-1.5.0, bdd-6.1.1, metadata-3.1.1, playwright-0.7.1, anyio-3.6.1
collecting ... collected 5 items

tests/authentication/test_01_username_enumeration.py::test_username_enumeration Attack type configured: Username Enumeration
Invalid: username | Valid: password

============================================================
STARTING ATTACK: username enumeration attack
============================================================
Total attempts to perform: 10 (wrong credentials)
Final attempt: 1 (correct credentials)
------------------------------------------------------------
Attempt 1/10: username='user1', password='Admin123'
  Result: Login FAILED
Attempt 2/10: username='user2', password='Admin123'
  Result: Login FAILED
Attempt 3/10: username='user3', password='Admin123'
  Result: Login FAILED
Attempt 4/10: username='user4', password='Admin123'
  Result: Login FAILED
Attempt 5/10: username='user5', password='Admin123'
  Result: Login FAILED
Attempt 6/10: username='user6', password='Admin123'
  Result: Login FAILED
Attempt 7/10: username='user7', password='Admin123'
  Result: Login FAILED
Attempt 8/10: username='user8', password='Admin123'
  Result: Login FAILED
Attempt 9/10: username='user9', password='Admin123'
  Result: Login FAILED
Attempt 10/10: username='user10', password='Admin123'
  Result: Login FAILED
------------------------------------------------------------
Summary: 10/10 attempts failed as expected
------------------------------------------------------------

FINAL ATTEMPT: Correct credentials
Username: 'admin' | Password: 'Admin123'
Result: Login SUCCEEDED with correct credentials
============================================================
Attack Complexity: LOW (all attempts failed as expected)

CVSS VULNERABILITY SCORE CALCULATION
============================================================
Attack: username enumeration attack
Failed attempts: 10/10
Correct credentials: SUCCESS
------------------------------------------------------------
CVSS Base Score: 9.1
------------------------------------------------------------
CVSS Metrics:
  Attack Vector (AV): Network
  Attack Complexity (AC): Low
  Privileges Required (PR): None
  User Interaction (UI): None
  Scope (S): Unchanged
  Impact (CIA): High/High/High

Severity Rating: CRITICAL
============================================================

PASSED
tests/authentication/test_02_credential_guessing.py::test_credential_guessing Attack type configured: Credential Guessing
Invalid: username AND password

============================================================
STARTING ATTACK: credential guessing attack
============================================================
Total attempts to perform: 10 (wrong credentials)
Final attempt: 1 (correct credentials)
------------------------------------------------------------
Attempt 1/10: username='user1', password='pass1'
  Result: Login FAILED
Attempt 2/10: username='user2', password='pass2'
  Result: Login FAILED
Attempt 3/10: username='user3', password='pass3'
  Result: Login FAILED
Attempt 4/10: username='user4', password='pass4'
  Result: Login FAILED
Attempt 5/10: username='user5', password='pass5'
  Result: Login FAILED
Attempt 6/10: username='user6', password='pass6'
  Result: Login FAILED
Attempt 7/10: username='user7', password='pass7'
  Result: Login FAILED
Attempt 8/10: username='user8', password='pass8'
  Result: Login FAILED
Attempt 9/10: username='user9', password='pass9'
  Result: Login FAILED
Attempt 10/10: username='user10', password='pass10'
  Result: Login FAILED
------------------------------------------------------------
Summary: 10/10 attempts failed as expected
------------------------------------------------------------

FINAL ATTEMPT: Correct credentials
Username: 'admin' | Password: 'Admin123'
Result: Login SUCCEEDED with correct credentials
============================================================
Attack Complexity: LOW (all attempts failed as expected)

CVSS VULNERABILITY SCORE CALCULATION
============================================================
Attack: credential guessing attack
Failed attempts: 10/10
Correct credentials: SUCCESS
------------------------------------------------------------
CVSS Base Score: 9.1
------------------------------------------------------------
CVSS Metrics:
  Attack Vector (AV): Network
  Attack Complexity (AC): Low
  Privileges Required (PR): None
  User Interaction (UI): None
  Scope (S): Unchanged
  Impact (CIA): High/High/None

Severity Rating: CRITICAL
============================================================

PASSED
tests/authentication/test_03_password_attack_6_attempts.py::test_password_attack_6 Attack type configured: Password Attack
Valid: username | Invalid: password

============================================================
STARTING ATTACK: password attack
============================================================
Total attempts to perform: 6 (wrong passwords)
Final attempt: 1 (correct credentials)
------------------------------------------------------------
Attempt 1/6: username='admin', password='wrongpass1'
  Result: Login FAILED
Attempt 2/6: username='admin', password='wrongpass2'
  Result: Login FAILED
Attempt 3/6: username='admin', password='wrongpass3'
  Result: Login FAILED
Attempt 4/6: username='admin', password='wrongpass4'
  Result: Login FAILED
Attempt 5/6: username='admin', password='wrongpass5'
  Result: Login FAILED
Attempt 6/6: username='admin', password='wrongpass6'
  Result: Login FAILED

------------------------------------------------------------
Now attempting login with CORRECT credentials...
------------------------------------------------------------
Attempt 7: username='admin', password='Admin123'
  Result: Login SUCCEEDED

============================================================
CVSS VULNERABILITY SCORE CALCULATION
============================================================
Test: password attack
Security Status: System allowed 6+ attempts without blocking
Attack Complexity: LOW (0.77)
------------------------------------------------------------
CVSS Base Score: 9.1
------------------------------------------------------------
Total login attempts: 7
Failed attempts: 6
Correct credentials blocked: NO

CVSS Metrics:
  Attack Vector (AV): 0.85 (Network)
  Attack Complexity (AC): 0.77
  Privileges Required (PR): 0.85 (None)
  User Interaction (UI): 0.85 (None)
  Impact Score: 5.18
  Exploitability Score: 3.89
============================================================
PASSED
tests/authentication/test_04_password_attack_7_attempts.py::test_password_attack_7 Attack type configured: Password Attack
Valid: username | Invalid: password

============================================================
STARTING ATTACK: password attack
============================================================
Total attempts to perform: 7 (wrong passwords)
Final attempt: 1 (correct credentials)
------------------------------------------------------------
Attempt 1/7: username='admin', password='wrongpass1'
  Result: Login FAILED
Attempt 2/7: username='admin', password='wrongpass2'
  Result: Login FAILED
Attempt 3/7: username='admin', password='wrongpass3'
  Result: Login FAILED
Attempt 4/7: username='admin', password='wrongpass4'
  Result: Login FAILED
Attempt 5/7: username='admin', password='wrongpass5'
  Result: Login FAILED
Attempt 6/7: username='admin', password='wrongpass6'
  Result: Login FAILED
Attempt 7/7: username='admin', password='wrongpass7'
  Result: Login FAILED

------------------------------------------------------------
Now attempting login with CORRECT credentials...
------------------------------------------------------------
Attempt 8: username='admin', password='Admin123'
  Result: Login SUCCEEDED

============================================================
CVSS VULNERABILITY SCORE CALCULATION
============================================================
Test: password attack
Security Status: System allowed 7+ attempts without blocking
Attack Complexity: LOW (0.77)
------------------------------------------------------------
CVSS Base Score: 9.1
------------------------------------------------------------
Total login attempts: 8
Failed attempts: 7
Correct credentials blocked: NO

CVSS Metrics:
  Attack Vector (AV): 0.85 (Network)
  Attack Complexity (AC): 0.77
  Privileges Required (PR): 0.85 (None)
  User Interaction (UI): 0.85 (None)
  Impact Score: 5.18
  Exploitability Score: 3.89
============================================================
PASSED
tests/authentication/test_05_password_attack_8_attempts.py::test_password_attack_8 Attack type configured: Password Attack
Valid: username | Invalid: password

============================================================
STARTING ATTACK: password attack
============================================================
Total attempts to perform: 8 (wrong passwords)
Final attempt: 1 (correct credentials)
------------------------------------------------------------
Attempt 1/8: username='admin', password='wrongpass1'
  Result: Login FAILED
Attempt 2/8: username='admin', password='wrongpass2'
  Result: Login FAILED
Attempt 3/8: username='admin', password='wrongpass3'
  Result: Login FAILED
Attempt 4/8: username='admin', password='wrongpass4'
  Result: Login FAILED
Attempt 5/8: username='admin', password='wrongpass5'
  Result: Login FAILED
Attempt 6/8: username='admin', password='wrongpass6'
  Result: Login FAILED
Attempt 7/8: username='admin', password='wrongpass7'
  Result: Login FAILED
Attempt 8/8: username='admin', password='wrongpass8'
  Result: Login FAILED

------------------------------------------------------------
Now attempting login with CORRECT credentials...
------------------------------------------------------------
Attempt 9: username='admin', password='Admin123'
  Result: Login FAILED (System blocked correct credentials)

============================================================
CVSS VULNERABILITY SCORE CALCULATION
============================================================
Test: password attack
Security Status: System blocked ALL attempts (including correct credentials)
Attack Complexity: HIGH (0.44)
------------------------------------------------------------
CVSS Base Score: 7.4
------------------------------------------------------------
Total login attempts: 9
Failed attempts: 9
Correct credentials blocked: YES

CVSS Metrics:
  Attack Vector (AV): 0.85 (Network)
  Attack Complexity (AC): 0.44
  Privileges Required (PR): 0.85 (None)
  User Interaction (UI): 0.85 (None)
  Impact Score: 5.18
  Exploitability Score: 2.22
============================================================
PASSED

================================ warnings summary ================================
tests/authentication/test_01_username_enumeration.py::test_username_enumeration
tests/authentication/test_02_credential_guessing.py::test_credential_guessing
tests/authentication/test_03_password_attack_6_attempts.py::test_password_attack_6
tests/authentication/test_04_password_attack_7_attempts.py::test_password_attack_7
tests/authentication/test_05_password_attack_8_attempts.py::test_password_attack_8
  /opt/tljh/user/lib/python3.9/asyncio/subprocess.py:196: DeprecationWarning: The loop argument is deprecated since Python 3.8, and scheduled for removal in Python 3.10.
    stdin, stdout, stderr = await tasks.gather(stdin, stdout, stderr,

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
---------------------------------- JSON report -----------------------------------
report saved to: report.json
- Generated html report: file:///home/jupyter-yin10/Continuous_Security/openmrs-contrib-cvss-scanning/report.html -
=================== 5 passed, 5 warnings in 395.98s (0:06:35) ====================
